{"version":3,"sources":["../../../../../../src/visualBuilder/components/Collab/ThreadPopup/CommentCard.tsx"],"sourcesContent":["/** @jsxImportSource preact */\nimport React from \"preact/compat\";\nimport { useEffect, useState, useMemo } from \"preact/hooks\";\nimport CommentTextArea from \"./CommentTextArea\";\nimport {\n    ICommentCard,\n    IMessageDTO,\n    IUserDTO,\n} from \"../../../types/collab.types\";\nimport { getUserName, formatDate } from \"../../../utils/collabUtils\";\nimport CommentActionBar from \"./CommentActionBar\";\nimport CommentResolvedText from \"./CommentResolvedText\";\nimport Avatar from \"../Avatar/Avatar\";\nimport ThreadBodyLoader from \"./loader/ThreadBody\";\nimport { collabStyles, flexAlignCenter } from \"../../../collab.style\";\nimport classNames from \"classnames\";\n\nconst formatCommentDate = (comment: IMessageDTO | null): string => {\n    return comment ? formatDate(comment.updatedAt || comment.createdAt) : \"\";\n};\n\nconst CommentCard = ({\n    userState,\n    comment,\n    onClose,\n    handleOnSaveRef,\n    mode,\n}: ICommentCard) => {\n    const [commentUser, setCommentUser] = useState<IUserDTO | null>(null);\n    const [isHovered, setIsHovered] = useState(false);\n\n    useEffect(() => {\n        setCommentUser(\n            comment\n                ? userState.userMap[comment.createdBy]\n                : userState.currentUser\n        );\n    }, [comment, userState]);\n\n    const formattedDate = useMemo(() => formatCommentDate(comment), [comment]);\n\n    if (!commentUser) {\n        return <ThreadBodyLoader key=\"collab-thread-body--comment-loader\" />;\n    }\n\n    return (\n        <div\n            className={classNames(\n                \"collab-thread-comment--wrapper\",\n                collabStyles()[\"collab-thread-comment--wrapper\"]\n            )}\n            onMouseEnter={() => setIsHovered(true)}\n            onMouseLeave={() => setIsHovered(false)}\n        >\n            <div\n                className={classNames(\n                    \"collab-thread-comment--user-details\",\n                    \"flex-v-center\",\n                    collabStyles()[\"collab-thread-comment--user-details\"],\n                    flexAlignCenter\n                )}\n            >\n                <Avatar\n                    avatar={\n                        {\n                            name: getUserName(commentUser),\n                            id: commentUser.uid,\n                        } as any\n                    }\n                />\n                <div\n                    className={classNames(\n                        \"collab-thread-comment--user-details__text\",\n                        collabStyles()[\n                            \"collab-thread-comment--user-details__text\"\n                        ]\n                    )}\n                >\n                    <div\n                        className={classNames(\n                            \"collab-thread-comment--user-name\",\n                            collabStyles()[\"collab-thread-comment--user-name\"]\n                        )}\n                    >\n                        {getUserName(commentUser)}\n                    </div>\n                    {comment && (\n                        <div\n                            className={classNames(\n                                \"collab-thread-comment--time-details\",\n                                collabStyles()[\n                                    \"collab-thread-comment--time-details\"\n                                ]\n                            )}\n                        >\n                            {formattedDate}\n                        </div>\n                    )}\n                </div>\n                {isHovered && (\n                    <CommentActionBar\n                        mode={mode}\n                        commentUser={commentUser}\n                        currentUser={userState.currentUser}\n                        commentUID={comment?._id}\n                    />\n                )}\n            </div>\n            {mode === \"edit\" ? (\n                <CommentTextArea\n                    onClose={onClose}\n                    userState={userState}\n                    handleOnSaveRef={handleOnSaveRef}\n                    comment={comment}\n                />\n            ) : (\n                comment && (\n                    <CommentResolvedText\n                        comment={comment}\n                        userState={userState}\n                    />\n                )\n            )}\n        </div>\n    );\n};\n\nexport default CommentCard;\n"],"mappings":";;;AAEA,SAAS,WAAW,UAAU,eAAe;AAC7C,OAAO,qBAAqB;AAM5B,SAAS,aAAa,kBAAkB;AACxC,OAAO,sBAAsB;AAC7B,OAAO,yBAAyB;AAChC,OAAO,YAAY;AACnB,OAAO,sBAAsB;AAC7B,SAAS,cAAc,uBAAuB;AAC9C,OAAO,gBAAgB;AA2BR,cA4BC,YA5BD;AAzBf,IAAM,oBAAoB,CAAC,YAAwC;AAC/D,SAAO,UAAU,WAAW,QAAQ,aAAa,QAAQ,SAAS,IAAI;AAC1E;AAEA,IAAM,cAAc,CAAC;AAAA,EACjB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ,MAAoB;AAChB,QAAM,CAAC,aAAa,cAAc,IAAI,SAA0B,IAAI;AACpE,QAAM,CAAC,WAAW,YAAY,IAAI,SAAS,KAAK;AAEhD,YAAU,MAAM;AACZ;AAAA,MACI,UACM,UAAU,QAAQ,QAAQ,SAAS,IACnC,UAAU;AAAA,IACpB;AAAA,EACJ,GAAG,CAAC,SAAS,SAAS,CAAC;AAEvB,QAAM,gBAAgB,QAAQ,MAAM,kBAAkB,OAAO,GAAG,CAAC,OAAO,CAAC;AAEzE,MAAI,CAAC,aAAa;AACd,WAAO,oBAAC,sBAAqB,oCAAqC;AAAA,EACtE;AAEA,SACI;AAAA,IAAC;AAAA;AAAA,MACG,WAAW;AAAA,QACP;AAAA,QACA,aAAa,EAAE,gCAAgC;AAAA,MACnD;AAAA,MACA,cAAc,MAAM,aAAa,IAAI;AAAA,MACrC,cAAc,MAAM,aAAa,KAAK;AAAA,MAEtC;AAAA;AAAA,UAAC;AAAA;AAAA,YACG,WAAW;AAAA,cACP;AAAA,cACA;AAAA,cACA,aAAa,EAAE,qCAAqC;AAAA,cACpD;AAAA,YACJ;AAAA,YAEA;AAAA;AAAA,gBAAC;AAAA;AAAA,kBACG,QACI;AAAA,oBACI,MAAM,YAAY,WAAW;AAAA,oBAC7B,IAAI,YAAY;AAAA,kBACpB;AAAA;AAAA,cAER;AAAA,cACA;AAAA,gBAAC;AAAA;AAAA,kBACG,WAAW;AAAA,oBACP;AAAA,oBACA,aAAa,EACT,2CACJ;AAAA,kBACJ;AAAA,kBAEA;AAAA;AAAA,sBAAC;AAAA;AAAA,wBACG,WAAW;AAAA,0BACP;AAAA,0BACA,aAAa,EAAE,kCAAkC;AAAA,wBACrD;AAAA,wBAEC,sBAAY,WAAW;AAAA;AAAA,oBAC5B;AAAA,oBACC,WACG;AAAA,sBAAC;AAAA;AAAA,wBACG,WAAW;AAAA,0BACP;AAAA,0BACA,aAAa,EACT,qCACJ;AAAA,wBACJ;AAAA,wBAEC;AAAA;AAAA,oBACL;AAAA;AAAA;AAAA,cAER;AAAA,cACC,aACG;AAAA,gBAAC;AAAA;AAAA,kBACG;AAAA,kBACA;AAAA,kBACA,aAAa,UAAU;AAAA,kBACvB,YAAY,SAAS;AAAA;AAAA,cACzB;AAAA;AAAA;AAAA,QAER;AAAA,QACC,SAAS,SACN;AAAA,UAAC;AAAA;AAAA,YACG;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA;AAAA,QACJ,IAEA,WACI;AAAA,UAAC;AAAA;AAAA,YACG;AAAA,YACA;AAAA;AAAA,QACJ;AAAA;AAAA;AAAA,EAGZ;AAER;AAEA,IAAO,sBAAQ;","names":[]}