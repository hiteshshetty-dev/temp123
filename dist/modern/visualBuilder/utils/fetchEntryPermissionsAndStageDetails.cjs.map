{"version":3,"sources":["../../../../src/visualBuilder/utils/fetchEntryPermissionsAndStageDetails.ts"],"sourcesContent":["import { getEntryPermissionsCached } from \"./getEntryPermissionsCached\";\nimport { getResolvedVariantPermissions } from \"./getResolvedVariantPermissions\";\nimport { getWorkflowStageDetails } from \"./getWorkflowStageDetails\";\n\nexport async function fetchEntryPermissionsAndStageDetails({\n    entryUid,\n    contentTypeUid,\n    locale,\n    variantUid,\n    fieldPathWithIndex,\n}: {\n    entryUid: string;\n    contentTypeUid: string;\n    locale: string;\n    fieldPathWithIndex: string;\n    variantUid?: string | undefined;\n}) {\n    const entryAclPromise = getEntryPermissionsCached({\n        entryUid,\n        contentTypeUid,\n        locale,\n    });\n    const resolvedVariantPermissionsPromise = getResolvedVariantPermissions({\n        entry_uid: entryUid,\n        content_type_uid: contentTypeUid,\n        locale,\n        variant: variantUid,\n        fieldPathWithIndex,\n    });\n    const entryWorkflowStageDetailsPromise = getWorkflowStageDetails({\n        entryUid,\n        contentTypeUid,\n        locale,\n        variantUid,\n    });\n    const results = await Promise.allSettled([\n        entryAclPromise,\n        entryWorkflowStageDetailsPromise,\n        resolvedVariantPermissionsPromise\n    ]);\n    if (results[0].status === \"rejected\") {\n        console.debug(\n            \"[Visual Builder] Error retrieving entry permissions\",\n            results[0].reason\n        );\n    }\n    if (results[1].status === \"rejected\") {\n        console.debug(\n            \"[Visual Builder] Error retrieving entry stage details\",\n            results[1].reason\n        );\n    }\n    if (results[2].status === \"rejected\") {\n        console.debug(\n            \"[Visual Builder] Error retrieving resolved variant permissions\",\n            results[2].reason\n        );\n    }\n    const acl =\n        results[0].status === \"fulfilled\" ? results[0].value : undefined;\n    const workflowStage =\n        results[1].status === \"fulfilled\" ? results[1].value : undefined;\n    const resolvedVariantPermissions =\n        results[2].status === \"fulfilled\" ? results[2].value : undefined;\n    return {\n        acl,\n        workflowStage,\n        resolvedVariantPermissions,\n    };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCAA0C;AAC1C,2CAA8C;AAC9C,qCAAwC;AAExC,eAAsB,qCAAqC;AAAA,EACvD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ,GAMG;AACC,QAAM,sBAAkB,4DAA0B;AAAA,IAC9C;AAAA,IACA;AAAA,IACA;AAAA,EACJ,CAAC;AACD,QAAM,wCAAoC,oEAA8B;AAAA,IACpE,WAAW;AAAA,IACX,kBAAkB;AAAA,IAClB;AAAA,IACA,SAAS;AAAA,IACT;AAAA,EACJ,CAAC;AACD,QAAM,uCAAmC,wDAAwB;AAAA,IAC7D;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACJ,CAAC;AACD,QAAM,UAAU,MAAM,QAAQ,WAAW;AAAA,IACrC;AAAA,IACA;AAAA,IACA;AAAA,EACJ,CAAC;AACD,MAAI,QAAQ,CAAC,EAAE,WAAW,YAAY;AAClC,YAAQ;AAAA,MACJ;AAAA,MACA,QAAQ,CAAC,EAAE;AAAA,IACf;AAAA,EACJ;AACA,MAAI,QAAQ,CAAC,EAAE,WAAW,YAAY;AAClC,YAAQ;AAAA,MACJ;AAAA,MACA,QAAQ,CAAC,EAAE;AAAA,IACf;AAAA,EACJ;AACA,MAAI,QAAQ,CAAC,EAAE,WAAW,YAAY;AAClC,YAAQ;AAAA,MACJ;AAAA,MACA,QAAQ,CAAC,EAAE;AAAA,IACf;AAAA,EACJ;AACA,QAAM,MACF,QAAQ,CAAC,EAAE,WAAW,cAAc,QAAQ,CAAC,EAAE,QAAQ;AAC3D,QAAM,gBACF,QAAQ,CAAC,EAAE,WAAW,cAAc,QAAQ,CAAC,EAAE,QAAQ;AAC3D,QAAM,6BACF,QAAQ,CAAC,EAAE,WAAW,cAAc,QAAQ,CAAC,EAAE,QAAQ;AAC3D,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AACJ;","names":[]}