{"version":3,"sources":["../../../../src/visualBuilder/utils/getCsDataOfElement.ts"],"sourcesContent":["import { CslpData } from \"../../cslp/types/cslp.types\";\nimport { VisualBuilderCslpEventDetails } from \"../types/visualBuilder.types\";\nimport { extractDetailsFromCslp } from \"../../cslp/cslpdata\";\nimport { DATA_CSLP_ATTR_SELECTOR } from \"./constants\";\n\n/**\n * Returns the CSLP data of the closest ancestor element with a `data-cslp` attribute\n * to the target element of a mouse event.\n * @param event - The mouse event.\n * @returns The CSLP data of the closest ancestor element with a `data-cslp` attribute,\n * along with metadata and schema information for the corresponding field.\n */\nexport function getCsDataOfElement(\n    event: MouseEvent\n): VisualBuilderCslpEventDetails | undefined {\n    const targetElement = event.target as HTMLElement;\n    if (!targetElement) {\n        return;\n    }\n    const editableElement = targetElement.closest(\"[data-cslp]\");\n\n    if (!editableElement) {\n        return;\n    }\n    const cslpData = editableElement.getAttribute(\"data-cslp\");\n    if (!cslpData) {\n        return;\n    }\n    const fieldMetadata = extractDetailsFromCslp(cslpData);\n\n    return {\n        editableElement: editableElement,\n        cslpData,\n        fieldMetadata,\n    };\n}\n\nexport function getDOMEditStack(ele: Element): CslpData[] {\n    const cslpSet: string[] = [];\n    let curr: any = ele.closest(`[${DATA_CSLP_ATTR_SELECTOR}]`);\n    while (curr) {\n        const cslp = curr.getAttribute(DATA_CSLP_ATTR_SELECTOR)!;\n        const entryPrefix = cslp.split(\".\").slice(0, 3).join(\".\");\n        const hasSamePrevPrefix = (cslpSet.at(0) || \"\").startsWith(entryPrefix);\n        if (!hasSamePrevPrefix) {\n            cslpSet.unshift(cslp);\n        }\n        curr = curr.parentElement?.closest(`[${DATA_CSLP_ATTR_SELECTOR}]`);\n    }\n    return cslpSet.map((cslp) => extractDetailsFromCslp(cslp));\n}\n"],"mappings":";;;AAEA,SAAS,8BAA8B;AACvC,SAAS,+BAA+B;AASjC,SAAS,mBACZ,OACyC;AACzC,QAAM,gBAAgB,MAAM;AAC5B,MAAI,CAAC,eAAe;AAChB;AAAA,EACJ;AACA,QAAM,kBAAkB,cAAc,QAAQ,aAAa;AAE3D,MAAI,CAAC,iBAAiB;AAClB;AAAA,EACJ;AACA,QAAM,WAAW,gBAAgB,aAAa,WAAW;AACzD,MAAI,CAAC,UAAU;AACX;AAAA,EACJ;AACA,QAAM,gBAAgB,uBAAuB,QAAQ;AAErD,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AACJ;AAEO,SAAS,gBAAgB,KAA0B;AACtD,QAAM,UAAoB,CAAC;AAC3B,MAAI,OAAY,IAAI,QAAQ,IAAI,uBAAuB,GAAG;AAC1D,SAAO,MAAM;AACT,UAAM,OAAO,KAAK,aAAa,uBAAuB;AACtD,UAAM,cAAc,KAAK,MAAM,GAAG,EAAE,MAAM,GAAG,CAAC,EAAE,KAAK,GAAG;AACxD,UAAM,qBAAqB,QAAQ,GAAG,CAAC,KAAK,IAAI,WAAW,WAAW;AACtE,QAAI,CAAC,mBAAmB;AACpB,cAAQ,QAAQ,IAAI;AAAA,IACxB;AACA,WAAO,KAAK,eAAe,QAAQ,IAAI,uBAAuB,GAAG;AAAA,EACrE;AACA,SAAO,QAAQ,IAAI,CAAC,SAAS,uBAAuB,IAAI,CAAC;AAC7D;","names":[]}